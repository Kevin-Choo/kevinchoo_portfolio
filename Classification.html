<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Classification</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Classification.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 4.2.6, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "Site1",
		"logo": "images/default-logo.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Classification">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body"><header class="u-clearfix u-header u-header" id="sec-d9b0"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="https://nicepage.com" class="u-image u-logo u-image-1">
          <img src="images/default-logo.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;"><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</symbol>
</defs></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="index.html" style="padding: 10px 20px;">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="About.html" style="padding: 10px 20px;">About</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Contact.html" style="padding: 10px 20px;">Contact</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="EDA.html" style="padding: 10px 20px;">EDA</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="OUTLIERS.html" style="padding: 10px 20px;">OUTLIERS</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="VIZ.html" style="padding: 10px 20px;">VIZ</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="https://kevin-choo.github.io/kevinchoo_portfolio/binary_classification.html" style="padding: 10px 20px;">Binary Classification</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="index.html" style="padding: 10px 20px;">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="About.html" style="padding: 10px 20px;">About</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Contact.html" style="padding: 10px 20px;">Contact</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="EDA.html" style="padding: 10px 20px;">EDA</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="OUTLIERS.html" style="padding: 10px 20px;">OUTLIERS</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="VIZ.html" style="padding: 10px 20px;">VIZ</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://kevin-choo.github.io/kevinchoo_portfolio/binary_classification.html" style="padding: 10px 20px;">Binary Classification</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-361a">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_herb_drawer.jfif" alt="" data-image-width="701" data-image-height="480">
        <h1 class="u-align-center u-text u-text-default u-text-1" data-animation-name="pulse" data-animation-duration="1000" data-animation-direction="">BINARY<br>CLASSIFCIATION
        </h1>
      </div>
    </section>
    <section class="u-clearfix u-section-2" id="sec-0779">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h1 class="u-text u-text-default u-text-1">What is classification in Machine Learning?</h1>
        <p class="u-text u-text-2">Generally, there are 4 types of classifications:<br>1. Binary Classification<br>2. Multi-Class Classification<br>3. Multi-Label Classification<br>4. Imbalanced Classification
        </p>
        <p class="u-align-left u-text u-text-3">Binary Classifcation</p>
        <p class="u-align-left u-text u-text-4">Binary classification perhaps is the easiest one to understand. It's an action where we classify an object into either yes or no, 0 or 1, normal or abnormal. Example such as an email spam or not spam? Should a bank loan money to a customer or not? or should employees be promoted or not? A mechanic empties his messy toolbox and separate the mess into 2 piles, "keep" or "discard", that's also classification.<br>Popular algorithms used in binary classification are:<br>
          <br>-Logistic Regression<br>-k-Nearest Neighbors<br>-Decision Trees<br>-Support Vector Machine<br>-Naive Bayes
        </p>
        <p class="u-text u-text-default u-text-5">Multi-Class Classification</p>
        <p class="u-text u-text-6">Unlike binary classification, multi-class classification does not have just 2 classes to divide the dataset into. Instead we have a range of classes. It's sort of like nominal classification where things don't have obvious order but they are different from each other and the each have their own class. Example can be movie genre, animal species identification, and religious.<br>Popular algorithms used in this classifcation are:<br>
          <br>-k-Nearest Neighbors<br>-Decision Trees<br>-Naive Bayes<br>-Random Forest<br>-Gradient Boosting
        </p>
        <p class="u-align-left u-text u-text-7">Multi-Label Classification</p>
        <p class="u-align-left u-text u-text-8">The words "Multi-Labels" refers to an object of interest that has many labels. Example can be movie genre, take "The Witcher" as an example, we can classify that series as Action/Adventure/Fantasy genre. Another example is patient record, male/hispanic/O+/5'5".<br>Popular algorithms used in this classifcations are:<br>
          <br>-Multi-label Decision Trees<br>-Multi-label Random Forests<br>-Multi-label Gradient Boosting
        </p>
        <p class="u-text u-text-default u-text-9">Imbalanced Classification</p>
        <p class="u-text u-text-10">Imbalanced classification refers to unequal amount of negative and positive outcome in the dataset. Example can be fraud detection (most people don't commit fraud), detection of bad batch in a production line, and outlier detection. Imbalanced meaning we have more normal class than the abnormal class, we can use techniques such as:<br>
          <br>-Random Undersampling<br>-SMOTE Oversampling<br>
          <br>Common algorithms can be just like the ones in the binary classification.
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-3" id="sec-3b9b">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">Diabetes Classification</h2>
        <p class="u-text u-text-2">Today we will be working on the Pima Indian Women Diabetes dataset. We spent a lot of time cleaning up the dataset and get it to a point where we can actually use it to train an A.I.</p>
        <p class="u-align-left u-text u-text-3">Table 1 Load dependencies</p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_load_dependecies.JPG" alt="" data-image-width="454" data-image-height="340">
        <p class="u-text u-text-4">First thing first, we load the necessary libraries. We may or may not use all of them, these are libraries that I think may be we will use. Next, we load the clean database. I have saved a copy of cleaned dataset from previous project. Let's load it into the memory.</p>
        <p class="u-align-left u-text u-text-5">Table 2 Load clean database</p>
        <img class="u-image u-image-default u-image-2" src="images/classification/portfolio_classification_load_clean_dataset.JPG" alt="" data-image-width="983" data-image-height="226">
        <p class="u-text u-text-default u-text-6">In table 2, the "Outcome" column will be our outcome or dependent variable, the rest will be the indenpendent variables that contributed to the outcome. This type of Machine Learning is called supervised learning. The name says it all, we have outcomes to guide the machine and we have some independent variables that the machine can learn from. The machine learn from the guidance. The machine generalize what it learn and apply to a new patient. The machine will determine whether the new patient is diabetic or not. In order to facilitate the learning process, we will have to divide the data into X and Y.</p>
        <p class="u-align-left u-text u-text-7">Table 3 Split data into X and Y</p>
        <img class="u-image u-image-default u-image-3" src="images/classification/portfolio_classification_split_XY.JPG" alt="" data-image-width="470" data-image-height="67">
        <p class="u-text u-text-default u-text-8">X will be our independent variables and y will be the outcome that we are trying to predict. So how do we get X? Basically just drop y, everything else in the dataset can then be X. I also dropped the column "Unnamed: 0".</p>
      </div>
    </section>
    <section class="u-clearfix u-section-4" id="sec-6b2a">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-text u-text-default u-text-1">Table 4 Imbalanced output class</p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_imbalance.JPG" alt="" data-image-width="488" data-image-height="381">
        <p class="u-text u-text-2">The propotion of diabetic and non-diabetic are imbalanced. We have more Native American that are not diabetic that the diabetic ones (35% diabetic, 65% healthy). This presents a new problem. In a dataset with highly unbalanced classes, the classifier algorithm will always “predicts” the most common class without performing any analysis of the features and it will have a high accuracy rate, obviously not the correct one. Think of it like this; I am going to make a fruit punch for you, I will blind fold you, and you will tell me what's inside the drink. I will put a lot of watermelon in the juice machine and only one drop of lemmon juice. What do you think the fruit punch taste like? Watermenlon! You have learn that it's just watermelon juice that you're tasting and you have completely ignore the lemmon juice in it. This is the same for machine learning. So what can we do to force the machine to learn the minority class?</p>
        <p class="u-text u-text-default u-text-3">There are 3 things that we can do.&nbsp;<br>1. Sample down the majority.<br>2. Sample up the minority.<br>3. Assign different weights to the minority and the majority.
        </p>
        <p class="u-text u-text-default u-text-4">Let us look at each one and determine the best route. First one is to sample down, we need to decrease the amount of non-diabetic patients so that the total outcome match the amount of diabetic patients. The percentage of non-diabetic to diabetic patients are about 65% to 35%. In another word, we need to get rid of 30% of 500 healthy patients in order to match the 268 diabetic outcome. We have to remove 150 rows of data from the database. We only have 768 patients total and if we remove 150 that gives us even less data to feed the machine. Think of it like a blind person feeling an elephant in a room, if we take away parts of elephant, eventually an elephant will not look like an elephant anymore, and the blind person will get an incorrect image of an elephant. Option 1 is a bad option. We will not go with option 1.<br>Option 2, sample up the minority which is the diabetic outcome. This option is viable, we will not sway the result by adding more diabetic patients. The ML model will not learn the propotion of the diabetic patients, rather it's learning the characteristics of both outcomes.<br>Option 3, assign weights to outcomes. This is also a feasible solution. By assigning weight to learning, we basically ask the machine to learn more about class 1 than class 0. We will do both option 2 and option 3.
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-5" id="sec-1d3a">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">Correlations</h2>
        <p class="u-text u-text-default u-text-2">There is one more thing to go through before we start training the A.I. We need to look at correlationship between each variable. Rule of thumb is that if a variable has 70% or more correlation/overlap with another variable, we will get rid one of them, we only need one, there is no need to have 2 similar variables in an equation.</p>
        <p class="u-text u-text-default u-text-3">Table 5 Correlationships</p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_correlationships.JPG" alt="" data-image-width="779" data-image-height="814">
        <p class="u-text u-text-default u-text-4">From this heatmap we didn't see anything over 70% correlated. We did however notice that "skin thickness" and "BMI" are highly correlation. "Blood Glucose" and "outcome" are highly correlation. "Age" and "pregnancies" are highly correlated as well. If you notice, the correlations are positive meaning one element increase, the other element increase in the same direction as well. The correlationship between pregnancies and age are somewhat odd. Pima Indian women get pregnant more as they aged.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-6" id="sec-e476">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">Machine Learning Process</h2>
        <p class="u-text u-text-2">In this section we are going to split the data into training and hold off dataset. Why are we doing that? We already didn't have enough data to begin with. The reason being, we need something to evaluate the learning result, something that the machine hasn't seen. One way to do it is to have to machine evaluate the hold off dataset and see how accurate the machine predicted the results after learning from a big chunk of training data. It's much like taking a final exam in school to see well students perform.</p>
        <p class="u-text u-text-3">Before we begin, there are several rules that we need to keep in mind. Because we are training our machine on a very small dataset, it creates some problems for us, we need to be aware of:<br>
          <br>1. Overfitting<br>2. Use simple models instead of complicated models<br>3. Beware of the outliers<br>4. Select the right features to use only<br>5. Balance the dataset<br>6. Combine models (ensembles)
        </p>
        <p class="u-text u-text-4">Because our dataset is so small, it's easy for the machine to learn even the error or anything that's specific to the dataset only. The resulting model cannot be generalized to Native American female population. Another thing to beware of is to not use complicated model. The more complicated a model, the easier the machine will learn the error as well. We've already got rid of outliers but it's worth mentioning it again. Outliers will sway the results beyond recognition, we need to remove or impute it. As far as feature selection, I'm talking about using only keeping features that contribute to the result. Say if a feature only contribute 0.00001% to the result, we can just remove it. Two features that are highly correlated with each other, we just need one of them. There are many ways to accomplish feature selection, namely analysis of its correlation with target, importance analysis and recursive elimination. We will go through them in the future projects. We are going to balance the dataset using SMOTE (Synthetic Minority Oversampling Technique) in the second part of the training. The first part we will assign learning weight to outcome. The ensemble approach basically combines 2 or more models and get the "average" of the outcome, this approach almost guaranteed a good result. We will talk about ensemble in the future projects.</p>
        <p class="u-align-left u-text u-text-5">Table 6 Split data into training and testing sets</p>
        <img class="u-expanded-width u-image u-image-default u-image-1" src="images/classification/portfolio_classification_train_test_split.JPG" alt="" data-image-width="930" data-image-height="58">
        <p class="u-text u-text-default u-text-6">You probably wonder what's the above code all about? I am splitting X into X_train and X_test, y into y_train and y_test. The ratio of division is 80% dedicated as training data and 20% as testing data (test_size=0.2). I've used the random seed 42. ​Scikit-learn uses random permutations to generate the splits. The random state that we provide is used as a seed to the random number generator. This ensures that the random numbers are generated in the same order. Why 42? 42 is quite popular in data science world. There is no real reason to it, perhaps this is why:<br>
          <br>In Douglas Adams’s popular 1979 science-fiction novel&nbsp;The Hitchhiker’s Guide to the Galaxy,&nbsp;towards the end of the book, the supercomputer&nbsp;<a class="bv jb u-active-none u-border-none u-btn u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1" href="https://hitchhikers.fandom.com/wiki/Deep_Thought" rel="noopener ugc nofollow" target="_blank">Deep Thought</a>&nbsp;reveals that the answer to the great question of “life, the universe and everything” is 42.&nbsp;<br>
          <br>Credits go to&nbsp;<br> https://medium.com/geekculture/the-story-behind-random-seed-42-in-machine-learning-b838c4ac290a<br>
          <br>You can use any random seed number you want as long as they are integers. I have used 42 for many years like other cool kids. What happen if you don't specify random state in any of your data science formula where available? If you don't specify the random_state in the code, then every time you run(execute) your code a new random value is generated and the train and test datasets would have different values each time.
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-7" id="sec-f12a">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-text u-text-default u-text-1">What about the term "stratify"? It means I want to keep the proportion of the original outcome which is 65% healthy and 35% diabetic. I'm doing this because I want to assign class weight to the outcome later. If I don't assign stratify, the train_test_split module will not keep the original ratio, assigning class weight will be pointless at that point.</p>
        <p class="u-align-left u-text u-text-2">Table 7 Logistic Regression with class weight</p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_LR_learning_weight.JPG" alt="" data-image-width="1082" data-image-height="305">
        <p class="u-text u-text-default u-text-3">The simplest form in Logistic Regression, I assigned weight of 0.33 to class 0 and 0.67 to class 1. The result, 73% accuracy. Let's run several other algorithms and see what we will get. Another point that I want to mention here, usually ​accuracy never helps in imbalanced dataset. Evaluation should be done using Area under ROC or precision and recall depending on your need. For simplicity, we'll use accuracy.</p>
        <p class="u-align-left u-text u-text-4">Table 8 Random Forest, XGBoost, and kNN<br>
        </p>
        <img class="u-image u-image-default u-image-2" src="images/classification/portfolio_classification_rf_xgb_knn.JPG" alt="" data-image-width="836" data-image-height="486">
        <p class="u-text u-text-default u-text-5">We get 81% accuracy from both Random Forest and XGBoost algorthim, kNN wise we get only 70%</p>
      </div>
    </section>
    <section class="u-clearfix u-section-8" id="sec-828d">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">SMOTE</h2>
        <p class="u-text u-text-2">SMOTE stands for <span style="font-weight: 700;"></span>
          <span style="font-weight: 700;">Synthetic Minority Oversampling Technique.&nbsp;<span style="font-weight: 400;">It is a method to increase the minority class's count to equal to the majority class. It's easier for A.I. to learn the characteristics of the minority class if we have more samples, even though it's an artificial one.&nbsp;</span>
          </span>
        </p>
        <p class="u-align-left u-text u-text-3">Table 9 SMOTE<br>
        </p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_SMOTE.JPG" alt="" data-image-width="679" data-image-height="234">
        <p class="u-text u-text-default u-text-4">We have increased the diabetic count to 400 people in the training set. Pay attention to the X_sm, y_sm split. Notice that I only up sample the training data (X_train, y_train)? It's very imporant to remember that we should NOT up/down sample or do any augmentation to the validation dataset, test data needs to be in its original amount, proportion and form. There's an American saying "keep it real". We can do manipulation to the training data but shouldn't alter the test data.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-9" id="sec-a429">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-text u-text-1">Table 10 Various algorithms on SMOTE data<br>
        </p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_SMOTE_accuracy_various_algorithms1.JPG" alt="" data-image-width="1083" data-image-height="602">
        <img class="u-image u-image-default u-image-2" src="images/classification/portfolio_classification_SMOTE_accuracy_various_algorithms2.JPG" alt="" data-image-width="891" data-image-height="153">
        <p class="u-text u-text-2">Table 10 displayed various algorithms and their respective accuracy. Again, pay attention to the ".fit" part, I only ask the algorithm to learn from the training data X_sm and y_sm. When I do prediction I ask the algorithm to predict using X_test that we got from table 6. The last line of each cell I asked the algorithm to print out the accuracy score using X_test and y_test dataset from Table 6 as well. These test sets were not modified or altered in any way.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-10" id="sec-8d26">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-1">Data Leakage</h2>
        <p class="u-text u-text-default u-text-2">I think it's time I introduce the concept of data leakage. It ties to the reason why I only do up-sampling in the training data. Data leakage is a big problem in machine learning world. There are 2 types of data leakage:<br>
          <br>1. Target leakage<br>2. Train test contamination<br>
          <br>
          <span style="font-weight: 700;">Taget leakage</span> happens when one of the feature(s) include data that will not be available when making prediction. Look at it like in a regression model:<br>
          <br>y = C + X1 + X2 + X3 + ....<br>
          <br>One of the Xs isn't true anymore at the time of prediction. Let me give you an example. Remember the fruit punch? The chef think that adding lemon juice doesn't make the fruit punch taste any better and it's just a waste of money. The chef makes another cup of fruit punch for you and this time without the lemon juice. You were trained on a fruit punch with lemon juice but the "test dataset" is a cup of fruit punch without lemon juice. Second example would be a pesticide test. A pesticide company wants to know if the pesticide is effective towards certain pests or not. The scientist wants to see which part of the crop that a certain pest can cause damage to. He asks the farmer plant a field with certain crops. He takes the data prior to the pest infestation. A few days later the farmer saw bugs crawling all over the crops, so he applies pesticide to the crops. Scientist comes back and recorded the "damage" done to the crops by the pest and there isn't any damage done to the crops.
        </p>
        <p class="u-text u-text-3">
          <span style="font-weight: 700;">Train test contimation</span> refers to accidental sharing of data between training and testing data set. When we split the data into training and testing set, the goal is to make sure that they are kept separated and nothing shared between them. When I do SMOTE in table 9, I only do it to the training set, if I also do SMOTE on the testing set, I am basically contaminate the test result. By doing SMOTE, I am basically bringing outside data into the test set. In real world, the raw data doesn't have any SMOTE done to it, our model will not be able to predict well if we test it on real world data. The process of splitting is also very important. We want to make sure that we split our data PRIOR to any up/down sampling or any augmentation. After splitting the data, do up/down sampling or augmentation to the training dataset only. We can then test the result using the test dataset and can confidently say that our model is good. You may also ask, does imputing data prior to splitting them also considered contamination? Yes, it does! We are bringing in data that's not observed directly in the field. Idealy we want to just drop the NaN or rows with missing data and then split the data. Because our dataset is so small, that's not an option for us. Moreover, I also want to show you how data cleaning process is done, that's why we impute the data prior to splitting them. If the data collection is not done right, the rest are just damage control.
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-11" id="sec-dfcc">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-text u-text-1">Table 11 Hyperparameters tuning on random forest classifier<br>
        </p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_rf_hyperparameters_tuning.JPG" alt="" data-image-width="582" data-image-height="414">
        <p class="u-text u-text-2">Basically, I am giving the GridSearchCV algorithm a series of parameters and ask it to mix and match every possible combination and find the best accuracy and show me the result. I am also asking the algorithm to find it using the training data X_sm and y_sm.</p>
        <p class="u-text u-text-3">Table 12 GridsearchCV tried 25k combos<br>
        </p>
        <img class="u-image u-image-default u-image-2" src="images/classification/portfolio_classification_hyperparameters_tuning_combo.JPG" alt="" data-image-width="798" data-image-height="81">
        <p class="u-text u-text-default u-text-4">The algorithm tested different parameter combination 25 thousand times and the best accuracy is 86%. The whole process took 1 hour and 28 minutes with the hardware acceleration set to use GPU. I tried CPU as well and it took 1 hour 30 minutes.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-12" id="sec-96a1">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-align-left u-text u-text-1">Table 13 Best accuracy with Random Forest<br>
        </p>
        <img class="u-expanded-width u-image u-image-default u-image-1" src="images/classification/portfolio_classification_hyperparameters_best_accuracy.JPG" alt="" data-image-width="1029" data-image-height="169">
        <p class="u-text u-text-default u-text-2">We will apply the best parameters to the RandomForestClassifier. Mind you that we may not get 86% accuracy but it's worth a try. So here we go!</p>
        <p class="u-text u-text-3">Table 14 Best parameters with Random Forest<br>
        </p>
        <img class="u-image u-image-default u-image-2" src="images/classification/portfolio_classification_randomforestclassifier_best_param.JPG" alt="" data-image-width="845" data-image-height="281">
        <p class="u-text u-text-4">The best we get is 82%. Like I said in the beginning of the project, accuracy is not the best judgement for imbalanced data, we should use AUC ROC. I will demostrate that in the future project. As of now, we'll take what we have.</p>
        <p class="u-text u-text-5">Table 15 Saving final model to a pickle file<br>
        </p>
        <img class="u-image u-image-default u-image-3" src="images/classification/portfolio_classification_pickle.JPG" alt="" data-image-width="499" data-image-height="112">
        <p class="u-text u-text-default u-text-6">So now, we actually have a file named model.pkl saved. If you look carefully, we're storing the rf_clf3 model as a pickle file. Rf_clf3 is the model that we created using the best parameters. ​The term alluding to the database systems term&nbsp;<i>pickling. <span style="font-style: normal;">It's</span>&nbsp;<span style="font-style: normal;">a mechanism that serialize and de-serialize data which allowing us to implement the object on various applications, on of such application is web based application.</span></i>
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-13" id="sec-49b8">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-text u-text-default u-text-1">There are many web framework that we can use, several good ones like Django, web2py, Flask, and Bottle. Today we are going to use PyCharm IDE to develop the Pima Indian Diabetes Prediction app. We are going to use Flask to productionize the result. You may ask, what's Flask? Flask is a web framework, it’s a Python module that lets you develop web applications. What's web framework then? Web Framework represents a collection of libraries and modules that enable web application developers to write applications without worrying about low-level details such as protocol, thread management, and so on. So Flask is a web application framework written in Python.</p>
        <p class="u-text u-text-2">Table 16 Initializing Flask app<br>
        </p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_pycharm_create_load_model.JPG" alt="" data-image-width="529" data-image-height="215">
        <p class="u-text u-text-3">In Table 16, we first import necessary dependencies. Line 5 and 6, we created the Flask application. Line 9, we load the pickle file into the variable "model".</p>
        <p class="u-text u-text-4">Table 17 Running app<br>
        </p>
        <img class="u-image u-image-default u-image-2" src="images/classification/portfolio_classification_pycharm_run_app.JPG" alt="" data-image-width="782" data-image-height="456">
        <p class="u-text u-text-5">Line 12 we define the homepage. The "/" will take user to the homepage. Once users are in the homepage, the function "Home" will then start the index.html file. Next we create another app call predict. the "/predict" path (line 17) will bring user to the predict page once it is called. We are using the method POST instead of GET here because we are going to receive data from users. I put an if/else loop in this routine so that I can print "Non-Diabetic" or "Diabetic" string base on the prediction result. It's more friendly than "You are 0" or "You are 1".<br>
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-14" id="sec-e57d">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-text u-text-1">Next we create a variable float_features. This line will convert all integer to float. Next line will take all the float_features values and store them in a Numpy array. Now we're at the core of the method, we use the "model" pickle file to predict the "features" array and then store them into the variable "prediction". After the prediction we need to display the result. The return function will take users back to the index.html page and post the string "You are Diabetic or Non-diabetic" to show users. It seems like everything is ready now, all we need to do is to write the last 2 lines. The "app.run" line will start the web app. ​When the Python interpreter runs a module, the&nbsp;__name__&nbsp;variable will be set as &nbsp;__main__&nbsp;if the module that is being run is the main program.</p>
        <p class="u-text u-text-2">Table 18 Localhost is ready to predict<br>
        </p>
        <img class="u-image u-image-default u-image-1" src="images/classification/portfolio_classification_pycharm_localhost.JPG" alt="" data-image-width="536" data-image-height="224">
        <p class="u-text u-text-default u-text-3">After running the app.py, Flask generated a localhost and provided us with the IP and port to run it. Open up a web browser and type that in.</p>
        <p class="u-align-left u-text u-text-4">Table 19 homepage<br>
        </p>
        <img class="u-image u-image-default u-image-2" src="images/classification/portfolio_classification_prediction_page.JPG" alt="" data-image-width="1536" data-image-height="170">
        <p class="u-align-left u-text u-text-5">Table 20 homepage zoom in<br>
        </p>
        <img class="u-image u-image-default u-image-3" src="images/classification/portfolio_classification_homepage_zoom_in.JPG" alt="" data-image-width="752" data-image-height="120">
        <p class="u-text u-text-default u-text-6">Table 19 is the whole index.html page. Table 20, I zoom in to show you that I put in some suggested value range for users to input. Let's try some values.</p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-palette-1-base u-section-15" id="sec-69d5">
      <div class="u-clearfix u-sheet u-valign-middle-xs u-sheet-1">
        <div class="u-align-left u-expanded-width u-uploaded-video u-video u-video-1">
          <div class="embed-responsive">
            <video class="embed-responsive-item">
              <source src="images/classification/ML API - Google Chrome 2022-01-13 18-09-42.mp4" type="video/mp4">
              <p>Your browser does not support HTML5 video.</p>
            </video>
            <button class="u-video-poster"></button>
          </div>
        </div>
        <h2 class="u-text u-text-default u-text-1">Pima Indian Female Diabetes Prediction</h2>
        <p class="u-text u-text-2">Demonstration of how this prediction work</p>
      </div>
    </section>
    <section class="u-clearfix u-section-16" id="sec-60dd">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-text u-text-1">Video above I demonstrated 2 examples. First example I had in mind was a college kid. She's non-diabetic. Second example was a 41 year old mom with 2 kids. She's diabetic. I know a lot of web master probably going to talk to me about my sense of art. My focus is on data science and not the UI/UX of the webpage. I would rather an experience web designer design the page for me, they can do a much better job than I can.</p>
        <h2 class="u-text u-text-2">Conclusion</h2>
        <p class="u-text u-text-3"> There are 5 core steps in Machine learning. We started out getting the data, we clean, prepare and manipulate the data, we train the model, we test the model, and we improve the model. We went through these 5 core steps and finally, we productionize the result using Flask. The machine learning based model could provide a very efficient and fast prediction of patient's diabetic status if they don't already know. This is especially important for Native American tribes that live in the remote area and have limited access to healthcare. ​The increase in internet accessibility and use has led to an exponential growth of data. According to experts, 90% of the world’s data has been generated in the last 2-4 years.&nbsp;Machine learning makes it possible to quickly and automatically produce models that can analyze bigger and more complex data. It is very accurate even on a very large database. It is a promising technology however it still has a few obstacles to go through prior to full acceptance by the society. Liability is one of the obstacle, output interpretation is another problem. Remember that our accuracy is only 82%, what happen if the machine got it wrong with one of the user? The usage and the way a model is interpreted can undoubtedly add to the risk of bias. If the underlying data is a racist data, your machine may end up making a racist decision.<br>Thank you for reading my page! This is not the end of my project, we barely scratch the surface of Machine Learning, stay tuned, more are coming!
        </p>
      </div>
    </section>
    
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-5b18"><div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1">Sample text. Click to select the text box. Click again or double click to start editing the text.</p>
      </div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <a class="u-link" href="https://nicepage.com/templates" target="_blank">
        <span>Templates</span>
      </a>
      <p class="u-text">
        <span>created with</span>
      </p>
      <a class="u-link" href="https://nicepage.com/html-website-builder" target="_blank">
        <span>HTML Builder</span>
      </a>. 
    </section>
  </body>
</html>
