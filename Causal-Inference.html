<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Causal Inference</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Causal-Inference.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 4.8.2, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    
    
    
    
    
    
    
    
    
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "Site1",
		"logo": "images/default-logo.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Causal Inference">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body u-xl-mode"><header class="u-clearfix u-header u-header" id="sec-d9b0"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="https://nicepage.com" class="u-image u-logo u-image-1">
          <img src="images/default-logo.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg class="u-svg-link" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</g></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="index.html" style="padding: 10px 20px;">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="About.html" style="padding: 10px 20px;">About</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Contact.html" style="padding: 10px 20px;">Contact</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="EDA.html" style="padding: 10px 20px;">EDA</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="OUTLIERS.html" style="padding: 10px 20px;">OUTLIERS</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="VIZ.html" style="padding: 10px 20px;">VIZ</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="https://kevin-choo.github.io/kevinchoo_portfolio/binary_classification.html" style="padding: 10px 20px;">Binary Classification</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Causal-Inference.html" style="padding: 10px 20px;">Causal Inference</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="index.html">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="About.html">About</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Contact.html">Contact</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="EDA.html">EDA</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="OUTLIERS.html">OUTLIERS</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="VIZ.html">VIZ</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://kevin-choo.github.io/kevinchoo_portfolio/binary_classification.html">Binary Classification</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Causal-Inference.html">Causal Inference</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-1fa0">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="u-image u-image-default u-image-1" src="images/causal/causal_domino.jpg" alt="" data-image-width="1280" data-image-height="853">
        <h1 class="u-align-left u-text u-text-default u-text-1">Causal Inference</h1>
        <h2 class="u-align-left u-text u-text-default u-text-2">I do therefore I am</h2>
      </div>
    </section>
    <section class="u-clearfix u-section-2" id="sec-15ad">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-align-left u-text u-text-default u-text-1">What is Causal Inference?</h2>
        <p class="u-text u-text-default u-text-2"> Conventional or traditional ML learns patterns and correlations, they are suitable for production but not for decision making. What's suitable for decision making are causal inference and A/B testing. When it comes to making decision we need to know "why" of the subject. A lot of time testing is just not possible and we don't always know why something is happening. It could be cost saving, no test subject, or we just don't have data to analyze. Machine unable to learn the patterns of an experimental model, even if it could learn the pattern, extrapolation is something that we never knew. The purpose of Causal Analysis is to estimate the effect of an intervention on the outcome. Like the title said "I do, therefore I am".<br>
        </p>
        <p class="u-text u-text-default u-text-3"> Imagine that you want to lose weight, you decided to do the 16/8 intermittent fasting. The outcome is your body weight with the intermittent fasting plan that you use as your treatment, but what if you choose to use different intermittent fasting plan instead? Would there be any effect? We cannot go back in time and treat you with different intermittent fasting plan. This is why we do Causal Analysis and not machine learning prediction. We don't have any data on the different fasting plan; therefore we cannot train the machine.</p>
        <h2 class="u-align-left u-text u-text-default u-text-4">Introducing DoWhy package<br>
        </h2>
        <p class="u-text u-text-default u-text-5">In this part of project, we are going to use <a href="https://microsoft.github.io/dowhy/" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1">Microsoft's doWhy package</a> to run out test. We are going to use the Pima Indian diabetest dataset that we clean up previously.
        </p>
        <h2 class="u-align-left u-text u-text-default u-text-6">Four Steps of Causal Inference<br>
        </h2>
        <p class="u-text u-text-default u-text-7">There are four steps in DoWhy package that completes the Causal Analysis, they are as follow:<br>1. Model<br>2. Identify<br>3. Estimate<br>4. Refute
        </p>
        <p class="u-text u-text-default u-text-8">in Model part it's pretty straightforward, we create causal model using CausalModel module. The Identify step, we define the Treatment&nbsp;affecting the&nbsp;Outcome&nbsp;and verify if everything else is contant, would changing of the treatment affect the otcome? The Estimate part, we estimate how strong the treatment is to the outcome. Finally the Refute part, we validate an effect estimate from a causal estimator.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-3" id="sec-eadc">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">Defining The Problem<br>
        </h2>
        <p class="u-text u-text-default u-text-2">Naturally after learning the pattern of the Pima Indian population, the next question would be, why so many of the Pima Indian females are diabetic? Of course due to limitation of the availability of our dataset, we can only ask questions that we can answer using features in the dataset. Here's the question:</p>
        <p class="u-text u-text-default u-text-3"> “<span style="font-style: italic;">Would&nbsp;obesity affecting the diabetes status</span>?”
        </p>
        <p class="u-align-left u-text u-text-default u-text-4">Our null hypothesis would be yes obesity is affecting the diabetes status and alternative hypothesis would be no, obesity is not a factor. Let's get to work!</p>
        <h2 class="u-align-left u-text u-text-default u-text-5">Preliminary Stuff<br>
        </h2>
        <p class="u-align-left u-text u-text-default u-text-6">Table 1 Install DoWhy package</p>
        <img class="u-image u-image-default u-image-1" src="images/causal/causal_install_dowhy.JPG" alt="" data-image-width="587" data-image-height="124">
        <p class="u-align-left u-text u-text-default u-text-7">Table 2 Install icecream package</p>
        <img class="u-image u-image-default u-image-2" src="images/causal/causal_icecream.JPG" alt="" data-image-width="518" data-image-height="121">
        <p class="u-align-left u-text u-text-default u-text-8">Table 3 Import dependencies</p>
        <img class="u-image u-image-default u-image-3" src="images/causal/causal_import_dependencies.JPG" alt="" data-image-width="460" data-image-height="138">
      </div>
    </section>
    <section class="u-clearfix u-section-4" id="sec-64b1">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-align-left u-text u-text-default u-text-1">Table 3 Import dependencies and print the result using icecream</p>
        <img class="u-image u-image-default u-image-1" src="images/causal/causal_read_csv_icecream_print.JPG" alt="" data-image-width="796" data-image-height="158">
        <p class="u-align-left u-text u-text-default u-text-2">Table 4 Drop "Unnamed: 0" column</p>
        <img class="u-image u-image-default u-image-2" src="images/causal/causal_drop_unnamed.JPG" alt="" data-image-width="957" data-image-height="190">
        <p class="u-align-left u-text u-text-default u-text-3">Table 5 Gathering data related to our hypothesis</p>
        <img class="u-image u-image-default u-image-3" src="images/causal/causal_obese.JPG" alt="" data-image-width="948" data-image-height="213">
        <p class="u-text u-text-default u-text-4">Our hypothesis is to test whether obesity is affecting diabetes status. I used the "BMI" column as my index column, everyone that's over 30 I classificed them and marked them as obese. I then created a column name "Obese" and input that data. Now we have our "treatment" and we have our "Outcome".</p>
      </div>
    </section>
    <section class="u-clearfix u-section-5" id="sec-63dc">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-align-left u-text u-text-default u-text-1">Model</h2>
        <p class="u-text u-text-default u-text-2">First thing first, let's create our diagram model which contains our assumptions. The DoWhy package will use this assumptions to analyze the causal effect. So, it's a very important step, like the old saying, garbage in garbage out if you don't get it right.</p>
        <p class="u-align-left u-text u-text-default u-text-3">Table 6 Causal diagram</p>
        <img class="u-image u-image-default u-image-1" src="images/causal/causal_diagram.JPG" alt="" data-image-width="705" data-image-height="387">
        <p class="u-text u-text-default u-text-4">These are some assumptions that I can think of, I would advice you to work with your domain expert to get it accurate. There are a lot of confounders that could potentially impact the correlations of our diagram, we need to include and account for all of them. So, here are some of my assumptions:<br>
          <br>1. For Pima Indian female, as they age, their diabetic gene may be turn on. Age has something to do with their pedigree as well.<br>2. As we all know, a lot of people as they get older they tend to have higher blood pressure.<br>3. As we aged, our metabolism started to slow down and we started to gain weight and because we still eat the same amount of food, we started to gain weight and become obese.<br>4. Pregnancy can have effect on blood sugar.<br>5. If our blood sugar level increase, our insulin level also increase with it.<br>6. A lot of women tend to gain weight after pregnancy.<br>7. Pregnancy can cause high/low blood pressure, increase skin thickness, and cause blood sugar to go up or down.<br>8. Obesity is the cause of diabetes, pregnancies also could be the cause, may be not directly but as a confounder.<br>9. Obese people tend to have high blood pressure, higher BMI index, and higher skin thickness measurement.
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-6" id="sec-29e1">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-align-left u-text u-text-default u-text-1">Table 7 Causal graphic model</p>
        <img class="u-image u-image-default u-image-1" src="images/causal/causal_graph.JPG" alt="" data-image-width="518" data-image-height="526">
      </div>
    </section>
    <section class="u-clearfix u-section-7" id="sec-ebf3">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-align-left u-text u-text-default u-text-1">Identify</h2>
        <p class="u-text u-text-default u-text-2"> It is time to identify the treatment effect on the outcome. In our case, we want to know if Obesity (treatment) is the cause of Diabetes (Outcome).&nbsp;</p>
        <p class="u-align-left u-text u-text-default u-text-3">Table 8 Identify causal effect</p>
        <img class="u-expanded-width u-image u-image-default u-image-1" src="images/causal/causal_identify.JPG" alt="" data-image-width="1082" data-image-height="446">
        <p class="u-text u-text-default u-text-4">In Table 8, we see the description "Unconfoundedness" and the DoWhy assume that U is causing Obese and U is also causing Diabetes, then probability of Obese, Pregnancies, and U given Diabetes is positive is equal to probability of Obese and Pregnancies given Diabetes is positive. In another word, DoWhy is ignoring U in the process. It's picking up Obesity and Pregnancies as 2 main factors, which is good!</p>
      </div>
    </section>
    <section class="u-clearfix u-section-8" id="sec-ba5a">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-align-left u-text u-text-default u-text-1">Estimate</h2>
        <p class="u-text u-text-default u-text-2"> In this stage, we're trying to understand the treatment's causal effect on the outcome. The Estimate process is based on the change in the value of the treatment variable while other variables are set to constant. You will see how this is done in the next section. How strong the effect is a matter of which kind of statistical estimation we are using. For the list of estimation methods, please visit <a href="https://causalinference.gitlab.io/kdd-tutorial/methods.html" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1">Github's Methods For Causal Inference Part II</a>.
        </p>
        <p class="u-text u-text-default u-text-3">Table 9 Estimate causal effect</p>
        <img class="u-expanded-width u-image u-image-default u-image-1" src="images/causal/causal_estimate.JPG" alt="" data-image-width="1085" data-image-height="491">
        <p class="u-text u-text-default u-text-4">Let's get some terms clarified. ATE meaning Average Treatment Effect, it's just the mean treatment effect. <a href="https://www.youtube.com/watch?v=U1S8Rq8IcrY" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-2">Backdoor</a> is a term in do-calculus meaning it's not a direct path to the result. In another word through indirect path to Diabetes end result, we have to go through Pregnancies and possibly Unconfoundedness in order to get to the Outcome, that's why it is called backdoor.<br>From the result above, we obtain the mean estimate is 0.27884, it is equivalent to saying that the probability of becoming Diabetes is increased by 27.9% when the Pima Indian female is Obese and Pregnant. Wow, that is a high probability!<br>
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-9" id="sec-11a7">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-align-left u-text u-text-default u-text-1">Refute</h2>
        <p class="u-text u-text-default u-text-2">In this part of analysis, we want to challenge the obtained estimands. The reason we're challenging the estimands is that the causality itself is not based on the data. It's based on my assumptions (Table 6 and 7). We can apply some changes here to test the causality. We can replace the estimands using placibo and then test the causality. We can replace the estimands with some randome variables and test the causality.<br>
        </p>
        <p class="u-text u-text-default u-text-3">We are going to use "random common cause" as our variables to test the causality. We can't use placibo here because it requires more than 2 categories of data in our treatment column which we only have Obese or not Obese.&nbsp;</p>
        <p class="u-align-left u-text u-text-default u-text-4">Table 10 Random common cause</p>
        <img class="u-image u-image-default u-image-1" src="images/causal/causal_random_common_cause.JPG" alt="" data-image-width="637" data-image-height="123">
        <p class="u-text u-text-default u-text-5">Table 11 Refute result</p>
        <img class="u-image u-image-default u-image-2" src="images/causal/causal_random_common_cause_result.JPG" alt="" data-image-width="333" data-image-height="146">
        <p class="u-text u-text-default u-text-6">If the assumption was correct (table 6 and 7), the estimation should not change much even after adding some random effect. The reason being, these are independent variables that's not part of the causal model they should not have any effect on the model. Indeed, the estimated and new effect both were almost identical: 0.2788 and 0.2786. P value of 0.439 confirms that they are both within the model's confidence interval.</p>
      </div>
    </section>
    <section class="u-clearfix u-section-10" id="sec-f2e3">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-default u-text-1">Conclusion</h2>
        <p class="u-text u-text-default u-text-2"> Causal Analysis is a statistical experimental analysis to establish cause and effect. Its main purpose is to locate the root cause of an outcome and its causes. Causal Analysis is essentially different from the machine learning prediction. In machine learning we try to learn patterns of a problem and come up with model and use the model to predict an outcome. Causal Analysis on the other hand, approaches a treatment's effect based on the counterfactual or the data that do not exist. It doesn't predict anything.<br>In our Pima Indian case, we learned that Pregnancies and Obesity are the 2 main causes of Diabetes. The model further clarified that Pregnancies causes Obesity and then Obesity causes Diabetes.<br>The model assumption part you should get your domain expert involve so that you don't waste too much time in guessing. Thank you for reading!
        </p>
      </div>
    </section>
    
    
    
    
  </body>
</html>
